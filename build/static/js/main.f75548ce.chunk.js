(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{1070:function(e,a,t){},1071:function(e,a,t){},1072:function(e,a,t){"use strict";t.r(a);var n={};t.r(n),t.d(n,"dispatcher",(function(){return b})),t.d(n,"timeFormat",(function(){return p}));var s=t(0),r=t.n(s),c=t(10),o=t.n(c),i=t(2),l=t(3),m=t(4),u=t(5),d=t(7),v=t(6),f=(t(16),t(17),t(18),t(19),function(e){var a=e.users,t=e.active,n=e.onClose,s=Object.keys(a);return r.a.createElement("div",{className:"board-info ".concat(t?"board-info--active":"")},r.a.createElement("div",{className:"board-info__header"},r.a.createElement("b",null,"Chat room"),r.a.createElement("div",null,s.length," ",s.length>1?"members":"member"),r.a.createElement("button",{onClick:function(){return n()},className:"button-close board-info__close"})),r.a.createElement("div",{className:"board-users"},s.map((function(e,t){var n=a[e];return r.a.createElement("div",{key:t,className:"board-user flex align_center"},r.a.createElement("div",{className:"board-user__picture"},r.a.createElement("img",{className:"board-user__image",src:n.avatar,alt:n.name})),r.a.createElement("div",{className:"board-user__bar"},r.a.createElement("div",{className:"flex align_botom"},r.a.createElement("b",{className:"board-user__name"},"".concat(n.name," ").concat(n.secname)))))}))))}),g=function(e){Object(d.a)(t,e);var a=Object(v.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).state={users:n.props.users,isActive:!1},n.countMember=Object.keys(n.props.users).length,n.openInfo=n.openInfo.bind(Object(u.a)(n)),n}return Object(m.a)(t,[{key:"openInfo",value:function(){this.setState((function(e){var a=Object(i.a)({},e);return a.isActive=!a.isActive,a}))}},{key:"render",value:function(){var e=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"board-header"},r.a.createElement("div",{className:"flex align_center"},r.a.createElement("div",{className:"board-header__bar"},r.a.createElement("b",null,"Chat room"),r.a.createElement("div",null,this.countMember," ",this.countMember>1?"members":"member")),r.a.createElement("button",{onClick:function(){return e.openInfo()},className:"board-header__btn"},r.a.createElement("div",{className:"board-header__btn--dot"})))),r.a.createElement(f,{active:this.state.isActive,users:this.state.users,onClose:this.openInfo}))}}]),t}(s.Component),b=(t(20),function(e){var a=new CustomEvent("message",{detail:{message:Object(i.a)({},e)}});document.dispatchEvent(a)}),p=function(e){return e<10?"0".concat(e):e},h=(t(21),function(e){var a=e.message,t=e.onLoad,n=a.avatar,c=a.name,o=a.secname,i=a.date,l=a.text,m=a.color,u=a.type,d=a.idx,v={color:"#".concat(m)},f={backgroundColor:"#".concat(m)},g=p(i.getHours()),b=p(i.getMinutes());return Object(s.useEffect)((function(){return t()})),r.a.createElement("div",{className:"message"},r.a.createElement("div",{className:"flex align_end"},function(){var e=r.a.createElement("span",{className:"message-bar__time"},"".concat(g,":").concat(b)),a=r.a.createElement("div",null,l),t=r.a.createElement("div",{className:"message-image",style:f},r.a.createElement("img",{className:"message-image__item",src:n,alt:c})),s=r.a.createElement("span",{className:"message-bar__name",style:v},"".concat(c," ").concat(o));return 0===d&&"current"===u?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message-bar"},r.a.createElement("div",{className:"flex align_botom"},s,e),a)):d>0&&"current"===u?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message-bar"},r.a.createElement("div",{className:"flex align_botom"},e),a)):d>0&&"finish"===u?r.a.createElement(r.a.Fragment,null,t,r.a.createElement("div",{className:"message-bar message-bar--last"},r.a.createElement("div",{className:"flex align_botom"},e),a)):r.a.createElement(r.a.Fragment,null,t,r.a.createElement("div",{className:"message-bar message-bar--last"},r.a.createElement("div",{className:"flex align_botom"},s,e),a))}()))}),E=(t(22),function(e){var a=e.message,t=e.onLoad,n=a.avatar,c=a.name,o=a.secname,i=a.date,l=a.text,m=a.color,u=a.type,d=a.idx,v={color:"#".concat(m)},f={backgroundColor:"#".concat(m)},g=p(i.getHours()),b=p(i.getMinutes());Object(s.useEffect)((function(){return t()}));return r.a.createElement("div",{className:"message-self"},r.a.createElement("div",{className:"flex align_end"},function(){var e=r.a.createElement("span",{className:"message-self__time"},"".concat(g,":").concat(b)),a=r.a.createElement("div",null,l),t=r.a.createElement("div",{className:"message-self__image",style:f},r.a.createElement("img",{className:"message-self__item",src:n,alt:c})),s=r.a.createElement("span",{className:"message-bar__name",style:v},"".concat(c," ").concat(o));return 0===d&&"current"===u?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message-self__bar"},r.a.createElement("div",{className:"flex align_botom"},s,e),a)):d>0&&"current"===u?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message-self__bar"},r.a.createElement("div",{className:"flex align_botom"},e),a)):d>0&&"finish"===u?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message-self__bar message-self__bar--last"},r.a.createElement("div",{className:"flex align_botom"},e),a),t):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"message-self__bar message-self__bar--last"},r.a.createElement("div",{className:"flex align_botom"},s,e),a),t)}()))}),_=function(e){Object(d.a)(t,e);var a=Object(v.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).state={messages:n.props.messages},n.wrapperRef=r.a.createRef(),n.lastMessageUserId="",n.renderMessage=n.renderMessage.bind(Object(u.a)(n)),n.scrollBottom=n.scrollBottom.bind(Object(u.a)(n)),n}return Object(m.a)(t,[{key:"renderMessage",value:function(){var e=this,a=[];return this.state.messages.forEach((function(t,n){var s=e.props.users[t.user_id],r=Object(i.a)(Object(i.a)({},s),t),c=e.state.messages[n-1],o=e.state.messages[n+1];r.idx=0,c&&c.user_id===r.user_id&&(r.idx=a[n-1].idx+1),o&&o.user_id===r.user_id?r.type="current":r.type="finish",a.push(r)})),a.map((function(a,t){var n=r.a.createElement(h,{onLoad:e.scrollBottom,key:t,message:a});return a.user_id===e.props.token&&(n=r.a.createElement(E,{onLoad:e.scrollBottom,key:t,message:a})),n}))}},{key:"scrollBottom",value:function(){var e=this.wrapperRef.current;e.scrollTo(0,e.scrollHeight)}},{key:"render",value:function(){return r.a.createElement("div",{className:"board-window",ref:this.wrapperRef},r.a.createElement("div",{className:"flex flex_column align_start"},this.renderMessage()))}}]),t}(s.Component),N=(t(23),n),k=function(e){Object(d.a)(t,e);var a=Object(v.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).state={user:n.props.user,text:""},n.message={},n.dispatchMessage=n.dispatchMessage.bind(Object(u.a)(n)),n.setText=n.setText.bind(Object(u.a)(n)),n}return Object(m.a)(t,[{key:"setText",value:function(e){this.setState((function(a){var t=Object(i.a)({},a);return t.text=e,t}))}},{key:"dispatchMessage",value:function(){var e=this.state.text.trim();if(e){var a={id:this.state.user.id,date:new Date,user_id:this.state.user.id,text:e};this.message=Object(i.a)({},a),N.dispatcher(this.message),this.setText("")}}},{key:"keyEvent",value:function(e){13===e.keyCode&&this.dispatchMessage()}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"board-sender"},r.a.createElement("input",{onChange:function(a){return e.setText(a.target.value)},onKeyDown:function(a){return e.keyEvent(a)},value:this.state.text,className:"board-sender__input",placeholder:"Enter a message..."}),r.a.createElement("button",{onClick:function(){return e.dispatchMessage()},className:"board-sender__btn"}))}}]),t}(s.Component),j=t(1),O=t.n(j),y=[O.a.random.uuid(),O.a.random.uuid(),O.a.random.uuid(),O.a.random.uuid(),O.a.random.uuid(),O.a.random.uuid(),O.a.random.uuid(),O.a.random.uuid()],x=["".concat(O.a.name.firstName()),"".concat(O.a.name.firstName()),"".concat(O.a.name.firstName()),"".concat(O.a.name.firstName()),"".concat(O.a.name.firstName()),"".concat(O.a.name.firstName()),"".concat(O.a.name.firstName()),"".concat(O.a.name.firstName())],C=["".concat(O.a.name.lastName()),"".concat(O.a.name.lastName()),"".concat(O.a.name.lastName()),"".concat(O.a.name.lastName()),"".concat(O.a.name.lastName()),"".concat(O.a.name.lastName()),"".concat(O.a.name.lastName()),"".concat(O.a.name.lastName())],M=(O.a.image.avatar(),O.a.image.avatar(),O.a.image.avatar(),O.a.image.avatar(),O.a.image.avatar(),O.a.image.avatar(),O.a.image.avatar(),O.a.image.avatar(),[O.a.internet.color().replace("#","").toUpperCase(),O.a.internet.color().replace("#","").toUpperCase(),O.a.internet.color().replace("#","").toUpperCase(),O.a.internet.color().replace("#","").toUpperCase(),O.a.internet.color().replace("#","").toUpperCase(),O.a.internet.color().replace("#","").toUpperCase(),O.a.internet.color().replace("#","").toUpperCase(),O.a.internet.color().replace("#","").toUpperCase()]),I=function(){function e(a){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;Object(l.a)(this,e),this.subscriber=a,this.deelay=t}return Object(m.a)(e,[{key:"init",value:function(){var e=this,a=0,t=setInterval((function(){e.subscriber(e.createData()),(a+=1)>=15&&clearInterval(t)}),this.deelay)}},{key:"createData",value:function(){var e=O.a.random.number({min:0,max:7});return{id:O.a.random.uuid(),date:new Date,user_id:y[e],text:O.a.lorem.words(7)}}},{key:"getUsers",value:function(){for(var e={},a=0;a<8;a++)e[y[a]]={name:x[a],secname:C[a],color:M[a],avatar:"https://eu.ui-avatars.com/api/?name=".concat(x[a],"+").concat(C[a],"&background=").concat(M[a],"&&color=fff"),id:y[a]};return e[12345]={name:"Test",secname:"Testovich",color:"FF8D00",avatar:"https://eu.ui-avatars.com/api/?name=Test+Testovich&background=FF8D00&&color=fff",id:"12345"},e}}]),e}(),T=function(e){Object(d.a)(t,e);var a=Object(v.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).mocks=new I(N.dispatcher,1e3),n.state={users:n.mocks.getUsers(),token:n.props.token,messages:[]},n}return Object(m.a)(t,[{key:"messageEventListener",value:function(){var e=this;document.addEventListener("message",(function(a){var t=a.detail;e.setState((function(e){var a=Object(i.a)({},e);return a.messages.push(t.message),a}))}))}},{key:"componentDidMount",value:function(){this.mocks.init(),this.messageEventListener()}},{key:"render",value:function(){return r.a.createElement("div",{className:"board"},r.a.createElement(g,{users:this.state.users}),r.a.createElement(_,{token:this.state.token,users:this.state.users,messages:this.state.messages}),r.a.createElement(k,{user:this.state.users[this.state.token]}))}}]),t}(s.Component),w=(t(1070),function(e){Object(d.a)(t,e);var a=Object(v.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).state={login:"",pass:"",isError:!1},n.setInput=n.setInput.bind(Object(u.a)(n)),n}return Object(m.a)(t,[{key:"setInput",value:function(e){var a=e.name,t=e.value;this.setState((function(e){var n=Object(i.a)({},e);return n[a]=t.trim(),n}))}},{key:"dispatchData",value:function(e){e.preventDefault();var a=!1;if("test"!==this.state.login&&(a=!0),"test"!==this.state.pass&&(a=!0),!a)return localStorage.setItem("authToken","12345"),void this.props.onLogin("12345");this.setState((function(e){var a=Object(i.a)({},e);return a.isError=!0,a}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"login-title"},"Enter in chat room"),r.a.createElement("form",{className:"login-form"},r.a.createElement("input",{onChange:function(a){return e.setInput(a.target)},value:this.state.login,name:"login",className:"login-form__input",placeholder:"Your login"}),r.a.createElement("input",{onChange:function(a){return e.setInput(a.target)},value:this.state.pass,name:"pass",className:"login-form__input login-form__input--last",placeholder:"Your pass"}),this.state.isError?r.a.createElement("div",{className:"login-form__error"},"Wrong login or password"):"",r.a.createElement("button",{onClick:function(a){return e.dispatchData(a)},className:"login-form__btn"},"Sign in")))}}]),t}(s.Component)),F=function(e){Object(d.a)(t,e);var a=Object(v.a)(t);function t(e){var n;return Object(l.a)(this,t),(n=a.call(this,e)).state={token:null},n.updateToken=n.updateToken.bind(Object(u.a)(n)),n}return Object(m.a)(t,[{key:"updateToken",value:function(e){this.setState((function(a){var t=Object(i.a)({},a);return t.token=e,t}))}},{key:"componentDidMount",value:function(){var e=localStorage.getItem("authToken");e&&this.setState((function(a){var t=Object(i.a)({},a);return t.token=e,t}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},this.state.token?r.a.createElement(T,{token:this.state.token}):r.a.createElement(w,{onLogin:this.updateToken})))}}]),t}(s.Component);t(1071);o.a.render(r.a.createElement(F,null),document.getElementById("root"))},11:function(e,a,t){e.exports=t(1072)},16:function(e,a,t){},17:function(e,a,t){},18:function(e,a,t){},19:function(e,a,t){},20:function(e,a,t){},21:function(e,a,t){},22:function(e,a,t){},23:function(e,a,t){}},[[11,1,2]]]);
//# sourceMappingURL=main.f75548ce.chunk.js.map